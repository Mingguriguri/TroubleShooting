name: Convert Issue to Markdown

on:
  issues:
    types: [closed]

jobs:
  convert_issue:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

      - name: Convert issue to markdown
        uses: eunjae-lee/issue-to-markdown@v1
        with:
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
          dest: 'logs'
          extension: '.md'
          inject_title: true
          inject_title_key: 'title'
          inject_created_at: true
          inject_created_at_key: 'created_at'
          inject_created_at_format: 'YYYY-MM-DD'
          inject_created_at_as_string: true

      - name: Commit and push changes
        run: |
          git config --local user.name 'github-actions'
          git config --local user.email 'github-actions@github.com'
          git add logs/
          git commit -m "docs: Convert issue to markdown"
          git push
